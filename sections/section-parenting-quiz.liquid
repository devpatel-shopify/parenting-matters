{%- if customer and customer.metafields.klaviyo.ParentingStyle -%}
<script type="text/javascript"> window.location.replace("{{ shop.url }}/pages/custom-parenting-style");</script>
{%- else -%}
<script type="text/javascript" src="//www.klaviyo.com/media/js/public/klaviyo_subscribe.js"></script>
{{ 'section-image-banner.css' | asset_url | stylesheet_tag }}
{{ 'section-contact-form.css' | asset_url | stylesheet_tag }}
{{ 'section-parenting-quiz.css' | asset_url | stylesheet_tag }}
    
{%- liquid
    assign ss = section.settings
    assign heading_font = ss.heading_font
-%}
{%- style -%}
  @media screen and (max-width: 749px) {
    .quiz_banner::before,
    .quiz_banner .banner__media::before,
    .quiz_banner:not(.banner--mobile-bottom) .banner__content::before {
      padding-bottom: {{ 1 | divided_by: ss.image.aspect_ratio | times: 100 }}%;
      content: '';
      display: block;
    }
  }

  @media screen and (min-width: 750px) {
    .quiz_banner::before,
    .quiz_banner .banner__media::before {
      padding-bottom: {{ 1 | divided_by: ss.image.aspect_ratio | times: 100 }}%;
      content: '';
      display: block;
    }
  }
{%- endstyle -%}

{%- if ss.form_id != blank -%}
{%- assign formID = ss.form_id | handleize -%}
<section class="ps-quiz color-{{ ss.color_scheme }}">
  <div class="banner quiz_banner banner--adapt banner--desktop-transparent banner--content-align-center banner--content-align-mobile-center">
    {%- if ss.image != blank -%}
    <div class="banner__media media">
    {%- assign image_height = ss.image.width | divided_by: ss.image.aspect_ratio -%}
    {{ ss.image
      | image_url: width: 3840
      | image_tag:
        loading: 'lazy',
        width: ss.image.width,
        height: image_height,
        sizes: '100vw',
        widths: '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
    }}
    </div>
    {%- else -%}
    <div class="banner__media media placeholder">
      {{ 'hero-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
    </div>
    {%- endif -%}
    <div class="banner__content banner__content--bottom-center page-width">
      <div class="banner__box content-container content-container--full-width-mobile color-{{ ss.color_scheme }} gradient">
        {%- if ss.banner_heading -%}
        <h2 class="banner__heading inline-richtext quiz_headline">
          {{ ss.banner_heading }}
        </h2>
        {%- endif -%}
        {%- if ss.banner_completed_heading -%}
        <h2 class="banner__heading inline-richtext quiz_complete_headline hidden">
          {{ ss.banner_completed_heading }}
        </h2>
        {%- else -%}
        <h2 class="banner__heading inline-richtext quiz_complete_headline hidden">
          {{ ss.banner_heading }}
        </h2>
        {%- endif -%}
      </div>
    </div>
  </div>
<div class="page-width">
    <form id="pq_quiz" class="quiz-section" action="//manage.kmail-lists.com/subscriptions/subscribe" data-ajax-submit="//manage.kmail-lists.com/ajax/subscriptions/subscribe" method="GET" target="_blank" novalidate="novalidate">
        <input type="hidden" name="g" value="SsT6w6">
        <input type="hidden" name="$list_fields" value="$consent">
        {%- assign fields = '' -%}
        <div class="quiz_questions">
        {%- for block in section.blocks -%}
            {%- liquid
                assign bs = block.settings
                assign field_name = bs.klaviyo_id | handleize
                assign size = section.blocks.size | minus: 1
                assign progress = forloop.index0 | times: 100 | divided_by: size
                assign slide_forloop = forloop.index

                assign name = "pq_questions_" | append: forloop.index0
                if bs.klaviyo_id
                    assign name = bs.klaviyo_id | handleize
                endif

                if field_name != ""
                    assign fields = fields | append: field_name | append: ","
                endif 
                capture background_color
                    cycle '#E9F0ED', '#F9E8E2', '#FFF0C9', '#FCEAD6'
                endcapture
                capture heading_color
                    cycle '#C9D9D3', '#F4D3DD', '#FFD978', '#F7C083'
                endcapture
                capture primary_color
                    cycle '#9CBFB3', '#C72457', '#F29630', '#F29630'
                endcapture
                capture button_color
                    cycle '#01333E', '#C72457', '#F29630', '#F29630'
                endcapture
            -%}
            <div id="quiz_slide-{{ block.id }}" class="quiz_slide slide {% unless forloop.first %} hidden{% endunless %}" data-klaviyoid="{{ bs.klaviyo_id }}"  {{ block.shopify_attributes }}>
                <style>
                #quiz_slide-{{ block.id }}{
                    --background-color: {{ bs.background_color | default: background_color }};
                    --heading-color: {{ bs.heading_color | default: heading_color }};
                    --primary-color: {{ bs.primary_color | default: primary_color }};
                    --secondary-color: {{ bs.heading_color | default: heading_color | color_lighten: 0.2 }};
                    --button-color: {{ bs.button_color | default: button_color }};
                    --progress: {{ progress | append: '%' }};
                }
                </style>
                <div class="quiz_header">                    
                    <div class="quiz_progress"><span class="progress"></span></div>
                    <div class="quiz_question_count"><span>Question {{ forloop.index }}/{{ section.blocks.size }}</span></div>
                    {%- if bs.q_group_title != blank -%}<div class="quiz_subheading rte"><p>{{ bs.q_group_title }}</p></div>{%- endif -%}
                    {%- if bs.q != blank -%}<h2 class="quiz_heading">{{ bs.q | newline_to_br }}</h2>{%- endif -%}
                </div>
                <div class="quiz_content">
                    {%- if block.type == 'textfield' -%}
                      <div class="rte error_message"><p>Please write your answer here...</p></div>
                    {%- else -%}
                    <div class="rte error_message"><p>Select any single option</p></div>
                    {%- endif -%}
                {% case block.type %}
                    {%- when 'range' -%}
                    <div class="range_container">
                        {%- if bs.a1 != blank -%}
                        <div class="range_rte range_rte-first large-up-hide">
                            <div class="rte">
                                <p>{{ bs.a1 }}</p>
                            </div>
                        </div>
                        {%- endif -%}
                        <div class="range_relative">
                            <div class="range_bar"></div>
                            <div class="range_wrapper">
                                {%- for radio in (1..4) -%}
                                {%- capture values -%} {% cycle '-2', '-1', '1', '2' - %}{%- endcapture -%}
                                <div class="radio_item">
                                    <input class="visually-hidden" type="radio" id="{{ name }}-{{ block.id }}-{{ forloop.index }}" name="{{ name }}" value="{{ values }}" data-input-index="{{ slide_forloop }}" data-val="{{ values }}" required>
                                    <label for="{{ name }}-{{ block.id }}-{{ forloop.index }}" class="radio_label"><span class="box"></span></label>
                                </div> 
                                {%- endfor -%}                                
                            </div>
                        </div>
                        {%- if bs.a2 != blank -%}
                        <div class="range_rte range_rte-second large-up-hide">
                            <div class="rte">
                                <p>{{ bs.a2 }}</p>
                            </div>
                        </div>
                        {%- endif -%}
                        {%- if bs.a1 != blank or bs.a2 != blank -%}
                        <div class="range_rte medium-hide small-hide">
                            {%- if bs.a1 != blank -%}
                            <div class="rte">
                                <p>{{ bs.a1 }}</p>
                            </div>
                            {%- endif -%}
                            {%- if bs.a2 != blank -%}
                            <div class="rte">
                                <p>{{ bs.a2 }}</p>
                            </div>
                            {%- endif -%}
                        </div>
                        {%- endif -%}
                        <input type="hidden" id="slidervalue{{ slide_forloop }}" data-id="{{ name }}" class="slide_value">
                    </div>
                    {% when 'button' %}
                    <div class="radio_container">
                        {%- if bs.a1 != blank -%}
                        <div class="radio_item">
                            <input class="visually-hidden" type="radio" id="{{ name }}-{{ block.id }}-1" name="{{ name }}" value="-2" data-input-index="{{ slide_forloop }}"  data-val="-2" required>
                            <label for="{{ name }}-{{ block.id }}-1" class="radio_label"><span class="box"></span> {{ bs.a1 }}</label>
                        </div>
                        {%- endif -%}
                        {%- if bs.a2 != blank -%}
                        <div class="radio_item">
                            <input class="visually-hidden" type="radio" id="{{ name }}-{{ block.id }}-2" name="{{ name }}" value="-1" data-input-index="{{ slide_forloop }}"  data-val="-1" required>
                            <label for="{{ name }}-{{ block.id }}-2" class="radio_label"><span class="box"></span> {{ bs.a2 }}</label>
                        </div>
                        {%- endif -%}
                        {%- if bs.a3 != blank -%}
                        <div class="radio_item">
                            <input class="visually-hidden" type="radio" id="{{ name }}-{{ block.id }}-3" name="{{ name }}" value="1" data-input-index="{{ slide_forloop }}"  data-val="1" required>
                            <label for="{{ name }}-{{ block.id }}-3" class="radio_label"><span class="box"></span> {{ bs.a3 }}</label>
                        </div>
                        {%- endif -%}
                        {%- if bs.a4 != blank -%}
                        <div class="radio_item">
                            <input class="visually-hidden" type="radio" id="{{ name }}-{{ block.id }}-4" name="{{ name }}" value="2" data-input-index="{{ slide_forloop }}"  data-val="2" required>
                            <label for="{{ name }}-{{ block.id }}-4" class="radio_label"><span class="box"></span> {{ bs.a4 }}</label>
                        </div>
                        {%- endif -%}
                        <input type="hidden" id="slidervalue{{ slide_forloop }}" data-id="{{ name }}" class="slide_value">
                    </div>
                    {% when 'textfield' %}
                    <div class="textarea_container">
                        <textarea name="{{ name }}" id="{{ bs.klaviyo_id }}" data-id="{{ name }}" placeholder="Enter your answer here..." rows="10" required></textarea>
                    </div>
                    {% when 'dropdown' %}
                    <div class="dropdown_container">
                        {%- assign options = bs.options | split: "," -%}
                        <details>
                        <summary class="dropdown_toggle">
                            <span>Select relationship person</span>
                            <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M7.38591 9.96708C7.17865 10.1496 7.15856 10.4655 7.34104 10.6728L11.7094 15.6343L11.7096 15.6346C11.7966 15.7331 11.9034 15.8121 12.0232 15.8661C12.143 15.9202 12.2729 15.9481 12.4042 15.9481C12.5356 15.9481 12.6655 15.9202 12.7853 15.8661C12.9051 15.8121 13.0119 15.7331 13.0988 15.6346L13.0992 15.6342L17.4666 10.6727C17.6491 10.4654 17.629 10.1495 17.4217 9.96705C17.2144 9.78459 16.8985 9.80471 16.716 10.012L12.4042 14.9102L8.09159 10.0119C7.90911 9.80469 7.59317 9.7846 7.38591 9.96708Z" fill="currentColor"/>
                                <rect x="0.5" y="0.5" width="23" height="23" rx="11.5" transform="matrix(1.19249e-08 1 1 -1.19249e-08 0.5 0.000122064)" stroke="currentColor"/>
                            </svg>                                
                        </summary>
                        <div class="dropdown_list">
                            {%- for option in options -%}
                            <div class="dropdown_item">
                                <input class="visually-hidden" type="radio" id="{{ name }}-{{ block.id }}-{{ forloop.index }}" name="{{ name }}" data-input-index="{{ slide_forloop }}" data-val="{{- option -}}" value="{{- option -}}" required>
                                <label for="{{ name }}-{{ block.id }}-{{ forloop.index }}" class="radio_label">{{- option -}}</label>
                            </div>
                            {%- endfor -%}
                        </div>
                        <input type="hidden" id="slidervalue{{ slide_forloop }}" data-id="{{ name }}" class="slide_value">
                    </div>
                {%- endcase -%}
                </div>
                <div class="quiz_footer">
                    {%- unless forloop.first -%}
                    <button type="button" class="button button_back">{% render 'icon-left-arrow' %} <span>Back</span></button>
                    {%- endunless -%}
                    {%- if forloop.last -%}
                    <button type="submit" class="button button_submit"><span>Submit</span> {% render 'icon-arrow' %}</button>
                    {%- else -%}
                    <button type="button" class="button button_next"><span>Next</span>{% render 'icon-arrow' %}</button>
                    {%- endif -%}
                </div>
            </div>
        {%- endfor -%}
        </div>
        {% assign fields = fields | append: "ParentingStyle" | append: "," %}
        {% assign fields = fields | append: "Xaxis" | append: "," %}
        {% assign fields = fields | append: "Yaxis" | append: "," %}
        {% assign fields = fields | append: "ParentingType" | append: "," %}
        <input type="hidden" id="ParentingStyle" name="ParentingStyle" value="">
        <input type="hidden" id="ParentingType" name="ParentingType" value="">
        <input type="hidden" id="Xaxis" name="Xaxis" value="">
        <input type="hidden" id="Yaxis" name="Yaxis" value="">
        {% comment %} <input type="hidden" id="pq_first_name" name="first_name" value="{% if customer %}{{ customer.first_name }}{% endif %}">
        <input type="hidden" id="pq_last_name" name="last_name" value="{% if customer %}{{ customer.last_name }}{% endif %}">
        <input type="hidden" type="email" id="pq_email" name="email" value="{% if customer %}{{ customer.email }}{% endif %}"> {% endcomment %}
        <input type="hidden" name="$fields" value="$consent,{{ fields }}">

        <div class="form-success-msg quiz_completed hidden">
            <div class="quiz_header">
                <div class="quiz_header_image">
                  <svg width="832" height="197" viewBox="0 0 832 197" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_3_15)">
                    <path d="M790.135 112.598C732.226 83.7452 786.493 46.3691 792.977 42.7515C831.903 21.0339 846.965 39.2058 850.803 51.9911C856.28 70.2326 848.044 141.45 790.135 112.598Z" fill="#DD7C9A"/>
                    <path d="M744.179 155.388C725.175 145.919 742.984 133.654 745.112 132.466C757.886 125.339 762.829 131.303 764.088 135.499C765.886 141.485 763.183 164.856 744.179 155.388Z" fill="#E9A7BC" fill-opacity="0.68"/>
                    <path d="M74.9312 100.432C140.452 168.815 47.2046 193.481 36.4826 195.26C-27.8858 205.937 -39.6535 173.453 -38.6213 153.94C-37.1487 126.099 9.4103 32.0488 74.9312 100.432Z" fill="#E9A7BC"/>
                    <path d="M46.6669 45.9302C39.6209 23.4483 63.1296 28.2557 65.7158 29.0443C81.2421 33.7781 80.275 42.3185 77.8885 46.5535C74.4835 52.5958 53.7128 68.4122 46.6669 45.9302Z" fill="#DD7C9A"/>
                    </g>
                    <defs>
                    <clipPath id="clip0_3_15">
                    <rect width="831" height="196" fill="white" transform="translate(0.5 0.500122)"/>
                    </clipPath>
                    </defs>
                    </svg>                    
                </div>
                <div class="quiz_question_count"><span>Your parenting style</span></div>
                <h2 class="quiz_heading" id="pstyle"></h2>
            </div>
            <div class="quiz_content">
                <div class="rte" id="description"></div>
            </div>
            <div class="quiz_lock">
              <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect y="0.00012207" width="48" height="48" rx="24" fill="#C72457"/>
                  <g clip-path="url(#clip0_1_1821)">
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M23.4445 9.84671C21.3661 9.93603 19.5085 10.4099 17.6758 11.3181C16.1981 12.0504 14.9474 12.969 13.7589 14.1947C12.5999 15.39 11.6524 16.8046 10.9795 18.344C10.3513 19.7814 9.97563 21.2604 9.84257 22.82C9.77772 23.5802 9.77774 24.4948 9.84262 25.2577C10.1169 28.4823 11.483 31.5083 13.7157 33.8368C14.5793 34.7375 15.4318 35.434 16.4747 36.0906C17.3804 36.6609 18.4673 37.1725 19.5054 37.5172C21.0464 38.0288 22.5541 38.259 24.2078 38.235C24.7785 38.2267 25.1355 38.2044 25.6633 38.144C28.1216 37.8627 30.5079 36.909 32.5029 35.4104C33.087 34.9716 33.4856 34.6246 34.0305 34.0801C34.3806 33.7303 34.5889 33.5052 34.8609 33.1827C36.0125 31.817 36.8719 30.2903 37.4563 28.5721C37.8199 27.503 38.0534 26.3718 38.1466 25.2281C38.2081 24.473 38.208 23.618 38.1465 22.8496C37.9574 20.4908 37.1561 18.1849 35.8318 16.1887C34.2674 13.8308 32.0086 11.9746 29.3967 10.9009C27.8637 10.2707 26.3082 9.92812 24.6279 9.8507C24.4027 9.84032 23.652 9.83779 23.4445 9.84671ZM23.5984 11.0766C23.2437 11.0892 22.8061 11.1214 22.4801 11.1588C20.6064 11.3741 18.7831 12.0118 17.1433 13.0253C15.8215 13.8422 14.5749 14.9868 13.6091 16.2703C12.778 17.3746 12.1141 18.6503 11.6721 19.9918C11.3283 21.0353 11.1391 22.0126 11.0524 23.1928C11.0326 23.4623 11.0326 24.6154 11.0524 24.8849C11.1844 26.6813 11.5984 28.2225 12.3686 29.7839C13.2035 31.4766 14.379 32.9395 15.883 34.1573C17.3104 35.3131 19.0611 36.1792 20.8826 36.6307C21.9045 36.8839 22.8966 37.0013 24.0066 37.0004C24.5466 37 24.8647 36.9847 25.3379 36.9366C28.0084 36.665 30.5749 35.538 32.5799 33.7564C32.8942 33.4771 33.4429 32.9281 33.7058 32.6298C34.1901 32.0805 34.6211 31.5066 34.9766 30.9377C36.4734 28.5425 37.143 25.7912 36.9162 22.9679C36.7396 20.7704 35.9854 18.6207 34.75 16.7942C34.0657 15.7825 33.2267 14.8551 32.2832 14.0677C30.269 12.3866 27.7868 11.3605 25.1604 11.1231C24.7703 11.0878 23.9597 11.0637 23.5984 11.0766ZM23.7167 15.751C23.5458 15.7665 23.325 15.7965 23.196 15.8218C22.5345 15.9513 21.9259 16.2365 21.3773 16.674C21.2141 16.8041 20.8908 17.1304 20.7514 17.3057C20.2484 17.9379 19.9461 18.6775 19.8589 19.4889C19.852 19.554 19.843 19.8001 19.839 20.0358L19.8318 20.4643L19.7833 20.4701C19.7566 20.4733 19.6975 20.4791 19.6519 20.483C19.4108 20.5034 19.1371 20.5972 18.9126 20.7365C18.4499 21.0234 18.1428 21.4976 18.0717 22.0346C18.0607 22.1178 18.0588 22.8569 18.0637 25.2474C18.0706 28.56 18.0677 28.4032 18.125 28.6306C18.169 28.8052 18.248 28.9904 18.3406 29.1361C18.6541 29.629 19.1647 29.9384 19.7289 29.9775C19.7972 29.9822 21.7568 29.9767 24.0835 29.9653C28.5704 29.9432 28.36 29.9467 28.5802 29.8909C29.3013 29.7084 29.8428 29.0756 29.9175 28.3284C29.9267 28.2364 29.9294 27.2982 29.9267 25.1275C29.9224 21.684 29.9309 21.9996 29.8352 21.7082C29.6839 21.2474 29.3622 20.8796 28.915 20.6559C28.72 20.5584 28.4103 20.4778 28.2281 20.4772L28.166 20.477L28.1658 20.1841C28.1656 19.7077 28.1408 19.3848 28.082 19.09C27.7797 17.5747 26.6518 16.3442 25.1673 15.9101C24.7964 15.8016 24.484 15.7563 24.0658 15.7503C23.9031 15.748 23.746 15.7483 23.7167 15.751ZM23.8112 16.9863C23.2467 17.0229 22.7001 17.2247 22.2433 17.5654C22.1119 17.6633 21.8037 17.9641 21.7022 18.0934C21.53 18.3126 21.3469 18.6417 21.2499 18.9062C21.1967 19.0513 21.1436 19.2563 21.1113 19.4409C21.0899 19.5635 21.0856 19.6458 21.0809 20.0244L21.0755 20.4652H22.187C22.7984 20.4652 24.1148 20.4687 25.1123 20.4731L26.9261 20.4809L26.9201 20.0263C26.9146 19.6057 26.9119 19.5594 26.8841 19.4061C26.7581 18.7124 26.4094 18.1106 25.8703 17.6565C25.3082 17.1829 24.5559 16.938 23.8112 16.9863ZM19.6993 21.7243C19.5578 21.7692 19.4171 21.8831 19.3574 22.001C19.2844 22.1451 19.2888 21.906 19.2973 25.2222C19.3056 28.5114 19.3014 28.3284 19.3711 28.4565C19.4422 28.5871 19.5988 28.7046 19.7455 28.7375C19.7949 28.7485 20.7349 28.7473 24.0044 28.7319C27.6429 28.7147 28.209 28.7098 28.2678 28.6944C28.4871 28.6373 28.6545 28.452 28.6865 28.231C28.7024 28.1206 28.7022 22.2988 28.6863 22.1882C28.6623 22.0224 28.5389 21.8478 28.3937 21.7742C28.2537 21.7033 28.5704 21.708 23.9652 21.7086C20.5883 21.7091 19.7372 21.7123 19.6993 21.7243ZM23.7995 22.849C23.6453 22.8821 23.5235 22.9421 23.4039 23.0438C23.1977 23.2192 23.0926 23.4315 23.0807 23.6964C23.0687 23.9651 23.1418 24.1692 23.3218 24.3694L23.3793 24.4333L23.3859 25.7774L23.3925 27.1214L23.4185 27.1915C23.486 27.3727 23.6396 27.5241 23.8098 27.5773C23.9709 27.6275 24.1336 27.6165 24.2807 27.5453C24.3731 27.5006 24.5075 27.3677 24.5541 27.275C24.6233 27.1375 24.6203 27.2092 24.6169 25.7593L24.6138 24.4209L24.6911 24.3251C24.7759 24.2201 24.8403 24.0975 24.873 23.9793C24.9063 23.8586 24.9028 23.5992 24.8664 23.4831C24.7737 23.1881 24.5444 22.9571 24.2551 22.8673C24.1482 22.8341 23.9128 22.8247 23.7995 22.849Z" fill="#FDF8EC"/>
                  </g>
                  <defs>
                  <clipPath id="clip0_1_1821">
                  <rect width="29.5833" height="29.5833" fill="white" transform="translate(9.20801 9.20845)"/>
                  </clipPath>
                  </defs>
              </svg>                        
            </div>
            <div class="quiz_footer">
              <h2 class="quiz_heading">To see your full results and access your dashboard register here. </h2>
              <div class="quiz_subheading rte"><p>You’ll also be emailed a copy of your results!</p></div>
              <div class="form">
                <div class=" field-box field--with-error">
                  <label class="visually-hidden" for="ContactForm-email">
                    {{- 'templates.contact.form.email' | t }}
                  </label>
                  <input
                    autocomplete="email"
                    type="email"
                    id="pq_email"
                    class=""
                    name="email"
                    spellcheck="false"
                    autocapitalize="off"
                    value="{% if customer %}{{ customer.email }}{% endif %}"
                    aria-required="true"
                    required
                    placeholder="Enter your email"
                  >
                </div>
                <div class="checkbox-field-box">
                    <input
                      id="confirmation_checkbox"
                      class="visually-hidden"
                      type="checkbox"
                      aria-required="true"
                      required
                    >
                    <label class="radio_label" for="confirmation_checkbox"><span class="box"></span>This had a disclaimer about agreeing to sign up for news, tips, and contact from Parenting Matters via email</label>
                </div>
                <div class="contact__button">
                  <button type="submit" class="button button--secondary">
                    {{ 'templates.contact.form.send' | t }}
                    <svg
                      aria-hidden="true"
                      class="icon icon-arrow"
                      focusable="false"
                      viewBox="0 0 21 20"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5561 0.385992C10.217 0.0873893 9.69997 0.12026 9.40136 0.45941C9.10276 0.79856 9.13563 1.31556 9.47478 1.61416L18.0699 9.18165H1.4217C0.969828 9.18165 0.603516 9.54796 0.603516 9.99983C0.603516 10.4517 0.969828 10.818 1.4217 10.818H18.0721L9.47484 18.386C9.13566 18.6845 9.10274 19.2015 9.40131 19.5407C9.69988 19.8799 10.2169 19.9128 10.5561 19.6142L20.0822 11.2287L20.0827 11.2282C20.2568 11.0746 20.3963 10.8858 20.4918 10.6742C20.5805 10.4777 20.6294 10.2658 20.636 10.0507C20.637 10.0339 20.6375 10.0169 20.6375 9.99983C20.6375 9.98206 20.637 9.96441 20.6358 9.94692C20.6288 9.73324 20.5799 9.52282 20.4918 9.32764C20.3963 9.11604 20.2568 8.92719 20.0827 8.77363L20.0822 8.77318L10.5561 0.385992Z" fill="currentColor"></path>
                    </svg>
                  </button>
                </div>          
              </div>
            </div>
        </div>
    </form>    
</div>
</section>

{%- assign ParentingStyleArray = "Well Balanced|‘Well-balanced’, with a tendency to being ‘Permissive’|‘Well-balanced’ with a tendency to being ‘Strict’|Strict|‘Strict’, with a tendency to ‘Well-balanced’|‘Strict’ with a tendency to ‘Hands-off’|Hands-off|‘Hands-off’ with a tendency towards being ‘Strict’|‘Hands-off’ with a tendency to being ‘Permissive’|Permissive|‘Permissive’ with a tendency to being ‘Hands-off’|‘Permissive’, with a tendency towards ‘Well-balanced’|Middle-of-the-Field" | split: '|' -%}

  <script type="application/json" id="parentingStyleDescriptionJson">
    {
      {%- for ParentingStyle in ParentingStyleArray -%}
        {%- assign styleHandleize = ParentingStyle | handleize -%}
        {{ ParentingStyle | json }}:{{ shop.metaobjects['parenting_style'][styleHandleize].description | metafield_tag | strip_newlines | json }}{%- unless forloop.last -%},{%- endunless -%}
      {%- endfor -%}
    }
  </script>
  <script defer>

      KlaviyoSubscribe.attachToForms('#pq_quiz', {
        hide_form_on_success: false,
        extra_properties: {
        $source: 'https://parenting-matters.myshopify.com/pages/parenting-style-quiz-1',
        $method_type: "Klaviyo Form",
        $method_id: 'embed',
        $consent_version: 'Embed default text',
        },
        success_url: "/account/register",
        custom_success_message: true
      });

    const parentingStyleDescriptions = JSON.parse(document.getElementById('parentingStyleDescriptionJson').innerText);
    document.addEventListener('DOMContentLoaded',function () {
      const slides = document.querySelectorAll('#pq_quiz .slide');
      
      slides.forEach((slide) =>{

        if(slide.querySelector('.dropdown_container')){
            slide.querySelectorAll('.dropdown_container .radio_label').forEach((radio) =>{
                radio.addEventListener('click',function(event){
                    slide.querySelector('.dropdown_container details').removeAttribute('open');
                    slide.querySelector('.dropdown_container .dropdown_toggle span').innerHTML =  radio.innerHTML;
                    slide.querySelector('.dropdown_container .slide_value').val =  radio.innerHTML;
                })
            })
        }

          if(slide.querySelector('.button_next')){
          slide.querySelector('.button_next').addEventListener('click',function(event){
            event.preventDefault();
            var btn = $(event.currentTarget);
            var isValid = false;
              if(btn.parents(".slide").find("input[type='radio']:checked").length){
                btn.parents(".slide").find(".quiz_content").removeClass("error");
                isValid = true;
              }else{
                btn.parents(".slide").find(".quiz_content").addClass("error");
              }  
            if(isValid){
              event.currentTarget.closest('.slide').nextElementSibling.classList.remove('hidden');
              event.currentTarget.closest('.slide').classList.add('hidden');
            }
          })
        }
        if(slide.querySelector('.button_back')){
          slide.querySelector('.button_back').addEventListener('click', function(event){
            event.preventDefault();
            event.currentTarget.closest('.slide').previousElementSibling.classList.remove('hidden');
            event.currentTarget.closest('.slide').classList.add('hidden');
          })
        }

        
        if(slide.querySelector('.button_submit')){

          slide.querySelector('.button_submit').addEventListener('click', function(event){
            event.preventDefault();

            var sbtn = $(event.currentTarget);
            /*var isValid = false;
              if(sbtn.parents(".slide").find("textarea").vaue != null){
                sbtn.parents(".slide").find(".quiz_content").removeClass("error");
                isValid = true;
              }else{
                sbtn.parents(".slide").find(".quiz_content").addClass("error");
              }*/

            const relationship = document.querySelector('[data-id="pq_childrelation"]').value;
            const comment = document.querySelector('[data-id="pq_comment"]').value;

            const larray = [1, 12];
            const darray = [6, 7, 9, 15, 17, 23, 24, 25, 11, 5, 19, 26];
            const uarray = [3, 4, 13, 21, 16];
            const rarray = [2, 8, 14, 20, 22, 10, 18];
            let l = 0;
            let d = 0;
            let u = 0;
            let r = 0;
            const score = {};

            for (let i = 1; i < 27; i++) {
              score[i] = parseFloat(document.getElementById('slidervalue' + i).value);
              console.log(score[i]);
              val = parseFloat(document.getElementById('slidervalue' + i).value);

      
              if (larray.includes(i)) {
                  if (val > 0) {
                      d += val;
                  } else {
                      l += val;
                  }
              }
              if (darray.includes(i)) {
                  if (val < 0) {
                      d -= val;
                  } else {
                      l -= val;
                  }
              }
              if (uarray.includes(i)) {
                  if (val > 0) {
                      r += val;
                  } else {
                      u += val;
                  }
              }
              if (rarray.includes(i)) {
                  if (val < 0) {
                      r -= val;
                  } else {
                      u -= val;
                  }
              }
            }

            const text_score = JSON.stringify(score);


            //console.log(text_score);
            //console.log(relationship);
            //console.log(comment);

            // Factor for 12 and 14 questions of each type
            // and a maximum scale value for each of 20
            l = (l * 20) / 28;
            d = (d * 20) / 28;
            u = (u * 20) / 24;
            r = (r * 20) / 24;
            const x = d + l;
            const y = r + u;

            console.log("l",l);
            console.log("d",d);
            console.log("u",u);
            console.log("r",r);
            console.log("x",x);
            console.log("y",y);


            var xaxis=parseFloat(x);
            var yaxis=parseFloat(y);

            var slope=yaxis/xaxis;

            var description = '';
            var pstyle = '';

            // var r=parseFloat(r);
            // var u=parseFloat(u);
            // var l=parseFloat(l);
            // var d=parseFloat(d);


            /**Top right quadrant*/
            if (xaxis > 0 && yaxis > 0){
                description = 'primarily Balanced-authoritative which is a good combination of  warmth and involvement backed up by appropriate expectations and clear limits. ';
                pStyle='Well Balanced';
                pstylePDF='ba.pdf';
                pType='authoritarian';
              if (slope > 1.51){
                description=description + 'You are also inclined towards being Permissive-indulgent which means that you rate highly on warmth and engagement with your children but lower on level of control and setting clear limits for them.';
                pStyle="‘Well-balanced’, with a tendency to being ‘Permissive’";
                pstylePDF='bapi.pdf';
                pType='authoritarian';
              }if (slope < 0.66){
                description=description + 'You are also inclined towards being Authoritarian-strict which means that you rate more highly on levels of control and discipline.';
                pStyle="‘Well-balanced’ with a tendency to being ‘Strict’";
                pstylePDF='baas.pdf';
                pType='authoritarian';
              }
            } 
            
            /**Bottom right quadrant*/	
            if (xaxis>0 && yaxis<0){
                description = 'primarily Authoritarian-strict which means that you rate more highly on levels of control and discipline. ';
                pStyle='Strict';
                pstylePDF='as.pdf';
                pType='authoritarian';
              if (slope > -0.66){
                description=description + 'You are also inclined towards being Balanced-authoritative which is a good combination of  warmth and involvement backed up by appropriate expectations and clear limits.';
                pStyle="‘Strict’, with a tendency to ‘Well-balanced’";
                pstylePDF='asba.pdf';
                pType='authoritarian';
              }if (slope < -1.51){
                description=description + 'You are also inclined towards being \'Hands-off\' which means that you tend to have a more laissez-faire or less involved approach to your children.';
                pStyle="‘Strict’ with a tendency to ‘Hands-off’";
                pstylePDF='asho.pdf';
                pType='authoritarian';}}


            /**Bottom left quadrant*/
            if (xaxis<0 && yaxis<0){
                description = ' primarily \'Hands-off\' which means that you tend to have a more laissez-faire or less involved approach to your children. ';
                pStyle='Hands-off';
                pstylePDF='ho.pdf';
                pType='authoritarian';
              if (slope > 1.51){
                description=description + 'You are also inclined towards being Authoritarian-strict which means that you rate more highly on levels of control and discipline.';
                pStyle="‘Hands-off’ with a tendency towards being ‘Strict’";
                pstylePDF='hoas.pdf';
                pType='authoritarian';}
              if (slope < 0.66){
                description=description + 'You are also inclined towards being Permissive-indulgent which means that you rate highly on warmth and engagement with your children but lower on level of control and setting clear limits for them.';
                pStyle="‘Hands-off’ with a tendency to being ‘Permissive’";
                pstylePDF='hopi.pdf';
                pType='authoritarian';}}	



            /**Top left quadrant*/
            if (xaxis<0 && yaxis>0){
                description = ' primarily Permissive-indulgent which means that you rate highly on warmth and engagement with your children but lower on level of control and setting clear limits for them. ';
                pStyle="Permissive";
                pstylePDF='pi.pdf';
                pType='permissive';
              if (slope > -0.66){
                description=description + 'You are also inclined towards being \'Hands-off\' which means that you tend to have a more laissez-faire or less involved approach to your children.';
                pStyle="‘Permissive’ with a tendency to being ‘Hands-off’";
                pstylePDF='piho.pdf';
                pType='permissive';}
              if (slope < -1.51){
                description=description + 'You are also inclined towards being Balanced-authoritative which is a good combination of  warmth and involvement backed up by appropriate expectations and clear limits.';
                pStyle="‘Permissive’, with a tendency towards ‘Well-balanced’";
                pstylePDF='piba.pdf';
                pType='permissive';}}	
            


            /**Now the special cases
            1st - at the origin*/
            if (xaxis == 0 && yaxis == 0){
              description = 'Balanced between all styles';
              pStyle="Middle-of-the-Field";
              pstylePDF='styles.pdf';
              pType='authoritarian';
            }	
            
            /**2nd - on x axis to the right*/
            if (xaxis >0 && yaxis ==0){
              description = 'balanced between Balanced-authoritative which is a good combination of  warmth and involvement backed up by appropriate expectations and clear limits and Authoritarian-strict which means that you rate more highly on levels of control and discipline.';
              pStyle="‘Well-balanced’ with a tendency to being ‘Strict’";
              pstylePDF='baas.pdf';
              pType='authoritarian';
            }

            /**3rd on x axis to the left*/
            if (xaxis < 0 && yaxis == 0){
              description = 'balanced between Permissive-indulgent which means that you rate highly on warmth and engagement with your children but lower on level of control and setting clear limits for them and \'Hands-off\' which means that you tend to have a more laissez-faire or less involved approach to your children.';
              pStyle="‘Permissive’ with a tendency to being ‘Hands-off’";
              pstylePDF='piho.pdf';
              pType='permissive';
            }

            /**4th on yaxis at the top*/
            if (xaxis == 0 && yaxis > 0){
              description = 'balanced between Balanced-authoritative which is a good combination of  warmth and involvement backed up by appropriate expectations and clear limits\; and Permissive-indulgent which means that you rate highly on warmth and engagement with your children but lower on level of control and setting clear limits for them.';
              pStyle="‘Well-balanced’, with a tendency to being ‘Permissive’";
              pstylePDF='bapi.pdf';
              pType='authoritarian';
            }	

            /**5th on y axis at the bottom*/
            if (xaxis == 0 && yaxis < 0){
              description = 'balanced between \'Hands-off\' which means that you tend to have a more laissez-faire or less involved approach to your children and Authoritarian-strict which means that you rate more highly on levels of control and discipline.';
              pStyle="‘Hands-off’ with a tendency towards being ‘Strict’";
              pstylePDF='hoas.pdf';
              pType='authoritarian';
            }

            let MetaDescriptions = parentingStyleDescriptions[pStyle] || '';

            $("#pstyle").html(pStyle.trim().replaceAll('‘','<span>').replaceAll('’','</span>'));
            {% comment %} $("#description").text(description); {% endcomment %}
            $("#description").html(MetaDescriptions);
            $("#ParentingStyle").val(pStyle);
            $("#ParentingType").val(pType);

            
            $("#Xaxis").val(xaxis);
            $("#Yaxis").val(yaxis);
            
            
            /**Now adjust axes for the plot*/
            xaxis = xaxis + 20;
            yaxis = yaxis + 20;
            
              document.querySelector('.form-success-msg').classList.remove('hidden');
              document.querySelector('.quiz_headline').classList.add('hidden');
              document.querySelector('.quiz_complete_headline').classList.remove('hidden');
              event.currentTarget.closest('.slide').classList.add('hidden');
          })
        }

        
      });            

        // Script for setting a value based on change in range/radio input type.
        $(function () {
          // On change of Range Slider
          $(document).on('change', '.quiz_content input', function () {
            var val = $(this).val();
            var dataVal = $(this).data('val');
            var index = $(this).data('input-index');
            $("#slidervalue"+index).val(dataVal);
            //console.log(dataVal);
            console.log($("Slide","#slidervalue"+index).val());
          });

          // On change of Radio Button
          /*$(document).on('change', '.radio-container input', function () {
            $(".qtype-button.radio-container.error").removeClass("error");
            var val = $(this).data('val');
            var index = $(this).data('input-index');
            $("#slidervalue"+index).val(val);
            console.log(val);
            console.log($("#slidervalue"+index).val());            
          }) */

         //On change of create account fields.
         /* $(document).on('change', '#pq_first_name', function () {
            var fname = $(this).val();
            $("#pq_first_name").val(fname)
          });
          
          $(document).on('change', '#pq_last_name', function () {
            var fname = $(this).val();
            $("#pq_last_name").val(fname)
          }); */
          
          {% comment %} $(document).on('change', '#pq_email', function () {
            var fname = $(this).val();
            $("#pq_email").val(fname)
          }); {% endcomment %}


          $("#RegistrationSubmit").on("click",function(){
              $("#pq_quiz").submit();

                var escapedData = {
                    {% comment %} firstName: escape($("#pq_first_name").val()),
                    lastName: escape($("#pq_last_name").val()), {% endcomment %}
                    email: escape($("#pq_email").val()),
                    password: escape($("#RegisterForm-password").val()).replace(/\+/g, '%2B')
                }
                  var data = 'form_type=create_customer&utf8=%E2%9C%93&customer%5Bemail%5D=';
                  data += escapedData.email;
                  data += '&customer%5Bpassword%5D=';
                  data += escapedData.password;
                  $.post('/account', data)
                  .done(function(response){
                    var logErrors = $(response).find('.errors').text();
                    if (logErrors != '' && logErrors != 'undefined'){
                      alert(logErrors);
                    }
                    else{
                      //alert('success!');
                      //window.location.href = "{{ shop.url }}/account/login";
                    }
                  }).fail(function(){alert('error could not submit');});
                  return false;
          })
        });        
      },false);
  </script>


{%- endif -%}
{%- endif -%}



{% schema %}
{
  "name": "Parenting quiz",
  "class": "section-parenting_quiz banner_section",
  "settings": [
    { 
      "type": "header",
      "content": "Banner"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:sections.image-banner.settings.image.label"
    },
    {
      "type": "text",
      "id": "banner_heading",
      "label": "Heading",
      "default": "Parenting Quiz"
    },
    {
      "type": "text",
      "id": "banner_completed_heading",
      "label": "Complete Heading",
      "default": "Quiz complete!",
      "info": "This heading will show after quiz completed"
    },
    { 
      "type": "header",
      "content": "Form"
    },
    {
      "type": "text",
      "id": "form_id",
      "label": "Form ID",
      "info": "This name is used to feed the data into Klaviyo. This form ID will be handleized."
    },
    {
      "type": "textarea",
      "id": "success_title",
      "label": "Success title"
    },
    {
      "type": "textarea",
      "id": "success_overview",
      "label": "Success overview"
    },
    { 
      "type": "header",
      "content": "Color"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "default": "scheme_1",
      "label": "Color scheme"
    }
  ],
  "blocks": [
    {
      "type": "range",
      "name": "Question type: Range",
      "settings": [
        {
          "type": "text",
          "id": "klaviyo_id",
          "label": "Klaviyo field ID",
          "info": "Used for segmentation within Klaviyo. Must be unique."
        },
        {
            "type": "text",
            "id": "sq",
            "label": "Sub heading"
        },
        {
          "type": "textarea",
          "id": "q",
          "label": "Question"
        },
        {
          "type": "text",
          "id": "a1",
          "label": "Answer 1",
          "info": "Enter the first answer value"
        },
        {
          "type": "text",
          "id": "a2",
          "label": "Answer 2",
          "info": "Enter the last answer value"
        },
        {
            "type": "header",
            "content": "Color"
        },
        {
            "type": "color",
            "id": "background_color",
            "label": "Background"
        },
        {
            "type": "color",
            "id": "heading_color",
            "label": "Heading"
        },
        {
            "type": "color",
            "id": "primary_color",
            "label": "Primary"
        },
        {
            "type": "color",
            "id": "button_color",
            "label": "Button"
        }
      ]
    },

    {
      "type": "button",
      "name": "Question type: Button",
      "settings": [
        {
          "type": "text",
          "id": "klaviyo_id",
          "label": "Klaviyo field ID",
          "info": "Used for segmentation within Klaviyo. Must be unique."
        },
        {
            "type": "text",
            "id": "sq",
            "label": "Sub heading"
        },
        {
          "type": "textarea",
          "id": "q_group_title",
          "label": "Question group title"
        },
        {
          "type": "textarea",
          "id": "q",
          "label": "Question"
        },
        {
          "type": "text",
          "id": "a1",
          "label": "Answer 1"
        },
        {
          "type": "text",
          "id": "a2",
          "label": "Answer 2"
        },
        {
          "type": "text",
          "id": "a3",
          "label": "Answer 3"
        },
        {
          "type": "text",
          "id": "a4",
          "label": "Answer 4"
        },
        {
            "type": "header",
            "content": "Color"
        },
        {
            "type": "color",
            "id": "background_color",
            "label": "Background"
        },
        {
            "type": "color",
            "id": "heading_color",
            "label": "Heading"
        },
        {
            "type": "color",
            "id": "primary_color",
            "label": "Primary"
        },
        {
            "type": "color",
            "id": "button_color",
            "label": "Button"
        }
      ]
    },

    {
      "type": "dropdown",
      "name": "Question type: Dropdown",
      "settings": [
        {
          "type": "text",
          "id": "klaviyo_id",
          "label": "Klaviyo field ID",
          "info": "Used for segmentation within Klaviyo. Must be unique."
        },
        {
            "type": "text",
            "id": "sq",
            "label": "Sub heading"
        },
        {
          "type": "textarea",
          "id": "q_group_title",
          "label": "Question group title"
        },
        {
          "type": "textarea",
          "id": "q",
          "label": "Question"
        },
        {
          "type": "textarea",
          "id": "options",
          "label": "Options",
          "info": "Add a comma between each option",
          "default": "Option 1, Option 2, Option 3, Option 4"
        },
        {
            "type": "header",
            "content": "Color"
        },
        {
            "type": "color",
            "id": "background_color",
            "label": "Background"
        },
        {
            "type": "color",
            "id": "heading_color",
            "label": "Heading"
        },
        {
            "type": "color",
            "id": "primary_color",
            "label": "Primary"
        },
        {
            "type": "color",
            "id": "button_color",
            "label": "Button"
        }
      ]
    },

    {
      "type": "textfield",
      "name": "Question type: Textfield",
      "settings": [
        {
          "type": "text",
          "id": "klaviyo_id",
          "label": "Klaviyo field ID",
          "info": "Used for segmentation within Klaviyo. Must be unique."
        },
        {
          "type": "textarea",
          "id": "q_group_title",
          "label": "Question group title"
        },
        {
          "type": "textarea",
          "id": "q",
          "label": "Question"
        },
        {
            "type": "header",
            "content": "Color"
        },
        {
            "type": "color",
            "id": "background_color",
            "label": "Background"
        },
        {
            "type": "color",
            "id": "heading_color",
            "label": "Heading"
        },
        {
            "type": "color",
            "id": "primary_color",
            "label": "Primary"
        },
        {
            "type": "color",
            "id": "button_color",
            "label": "Button"
        }
      ]
    }
  ],

  "presets": [
    {
      "name": "Parenting quiz"
    }
  ]
}
{% endschema %}